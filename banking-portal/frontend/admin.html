<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - SecureBank</title>
    <link rel="stylesheet" href="css/main.css">
</head>
<body>
    <header class="header">
        <div class="container">
            <nav class="navbar">
                <a href="/admin.html" class="logo"><span class="logo-icon">ðŸ”§</span><span>Admin Panel</span></a>
                <ul class="nav-menu">
                    <li><a href="/admin.html" class="nav-link active">Dashboard</a></li>
                    <li><a href="/dashboard.html" class="nav-link">User View</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="main-content" style="padding: 2rem 0;">
        <div class="container">
            <h1>ðŸ”§ Admin Dashboard</h1>

            <div class="grid grid-3">
                <div class="card">
                    <div class="card-body" style="text-align: center;">
                        <div style="font-size: 3rem; color: var(--primary-blue);" id="totalUsers">0</div>
                        <div style="color: var(--text-secondary);">Total Users</div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-body" style="text-align: center;">
                        <div style="font-size: 3rem; color: var(--success-green);" id="totalAccounts">0</div>
                        <div style="color: var(--text-secondary);">Total Accounts</div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-body" style="text-align: center;">
                        <div style="font-size: 3rem; color: var(--warning-yellow);" id="todayTransactions">0</div>
                        <div style="color: var(--text-secondary);">Today's Transactions</div>
                    </div>
                </div>
            </div>

            <div class="card mt-4">
                <div class="card-header"><h3 class="card-title">User Management</h3></div>
                <div class="card-body">
                    <div style="overflow-x: auto;">
                        <table class="transactions-table">
                            <thead>
                                <tr>
                                    <th>User ID</th>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Status</th>
                                    <th>Last Login</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="usersTable">
                                <tr><td colspan="6" style="text-align: center;"><div class="spinner" style="margin: 1rem auto;"></div></td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script src="js/auth.js"></script>
    <script>
        const user = checkAuth();
        if (!user || user.role !== 'admin') {
            window.location.href = '/dashboard.html';
        }

        document.addEventListener('DOMContentLoaded', async () => {
            try {
                const [dashRes, usersRes] = await Promise.all([
                    fetchAPI('/admin/dashboard'),
                    fetchAPI('/admin/users')
                ]);
                const dash = await dashRes.json();
                const users = await usersRes.json();

                document.getElementById('totalUsers').textContent = dash.dashboard.users.total;
                document.getElementById('totalAccounts').textContent = dash.dashboard.accounts.total;
                document.getElementById('todayTransactions').textContent = dash.dashboard.transactions.today;

                const tbody = document.getElementById('usersTable');
                tbody.innerHTML = users.users.map(u => `
                    <tr>
                        <td>${u.id}</td>
                        <td>${u.fullName}</td>
                        <td>${u.email}</td>
                        <td><span class="status-badge status-${u.isActive ? 'completed' : 'pending'}">${u.isActive ? 'Active' : 'Inactive'}</span></td>
                        <td>${new Date(u.lastLogin).toLocaleDateString()}</td>
                        <td><button class="btn btn-sm btn-outline">View</button></td>
                    </tr>
                `).join('');
            } catch (err) {
                console.error(err);
            }
        });
    </script>
</body>
</html>
